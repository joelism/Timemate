<!doctype html>
<meta charset="utf-8">
<title>TimeMate JW – Reset</title>
<h1>TimeMate JW – Reset</h1>
<p>Dieser Vorgang entfernt alte Service Worker & Caches für diese Domain.</p>
<button id="go">Jetzt zurücksetzen</button>
<pre id="log"></pre>
<script>
document.getElementById('go').addEventListener('click', async () => {
  const log = (m)=>{ document.getElementById('log').textContent += m + '\n'; };
  try {
    if ('serviceWorker' in navigator) {
      const regs = await navigator.serviceWorker.getRegistrations();
      for (const r of regs){ await r.unregister(); log('SW unregistered: ' + (r.scope||'')); }
    }
    if (window.caches) {
      const keys = await caches.keys();
      for (const k of keys){ await caches.delete(k); log('Cache deleted: ' + k); }
    }
    localStorage.clear(); sessionStorage.clear();
    log('Fertig. Seite neu laden…');
  } catch (e) {
    log('Fehler: ' + (e.message||e));
  }
});
</script>
